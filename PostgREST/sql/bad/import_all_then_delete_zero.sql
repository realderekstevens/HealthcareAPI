DROP TABLE IF EXISTS "2022_07";
DROP TABLE IF EXISTS "2022_06";
DROP TABLE IF EXISTS "2022_05";
DROP TABLE IF EXISTS "2022_04";
DROP TABLE IF EXISTS "2022_03";
DROP TABLE IF EXISTS "2022_02";
DROP TABLE IF EXISTS "2022_01";
DROP TABLE IF EXISTS "2021_12";
DROP TABLE IF EXISTS "2021_11";
DROP TABLE IF EXISTS "2021_10";
DROP TABLE IF EXISTS "2021_09";
DROP TABLE IF EXISTS "2021_08";
DROP TABLE IF EXISTS "2021_07";
DROP TABLE IF EXISTS "2021_06";
DROP TABLE IF EXISTS "2021_05";
DROP TABLE IF EXISTS "2021_04";
DROP TABLE IF EXISTS "2021_03";
DROP TABLE IF EXISTS "2021_02";
DROP TABLE IF EXISTS "2021_01";
DROP TABLE IF EXISTS "2020_12";
DROP TABLE IF EXISTS "2020_11";
DROP TABLE IF EXISTS "2020_10";
DROP TABLE IF EXISTS "2020_09";
DROP TABLE IF EXISTS "2020_08";
DROP TABLE IF EXISTS "2020_07";
DROP TABLE IF EXISTS "2020_06";
DROP TABLE IF EXISTS "2020_05";
DROP TABLE IF EXISTS "2020_04";
DROP TABLE IF EXISTS "2020_03";
DROP TABLE IF EXISTS "2020_02";
DROP TABLE IF EXISTS "2020_01";
DROP TABLE IF EXISTS "2019_12";
DROP TABLE IF EXISTS "2019_11";
DROP TABLE IF EXISTS "2019_10";
DROP TABLE IF EXISTS "2019_09";
DROP TABLE IF EXISTS "2019_08";
DROP TABLE IF EXISTS "2019_07";
DROP TABLE IF EXISTS "2019_06";
DROP TABLE IF EXISTS "2019_05";

CREATE TABLE "2022_07" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2022_07"
FROM 'J:\medicare\CPSC_Enrollment_Info_2022_07.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2022_07" WHERE Enrolled = '*';
ALTER TABLE "2022_07" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2022_07" DROP COLUMN ssa;
ALTER TABLE "2022_07" DROP COLUMN fips;

CREATE TABLE "2022_06" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2022_06"
FROM 'J:\medicare\CPSC_Enrollment_Info_2022_06.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2022_06" WHERE Enrolled = '*';
ALTER TABLE "2022_06" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2022_06" DROP COLUMN ssa;
ALTER TABLE "2022_06" DROP COLUMN fips;

CREATE TABLE "2022_05" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2022_05"
FROM 'J:\medicare\CPSC_Enrollment_Info_2022_05.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2022_05" WHERE Enrolled = '*';
ALTER TABLE "2022_05" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2022_05" DROP COLUMN ssa;
ALTER TABLE "2022_05" DROP COLUMN fips;

CREATE TABLE "2022_04" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2022_04"
FROM 'J:\medicare\CPSC_Enrollment_Info_2022_04.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2022_04" WHERE Enrolled = '*';
ALTER TABLE "2022_04" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2022_04" DROP COLUMN ssa;
ALTER TABLE "2022_04" DROP COLUMN fips;

CREATE TABLE "2022_03" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2022_03"
FROM 'J:\medicare\CPSC_Enrollment_Info_2022_03.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2022_03" WHERE Enrolled = '*';
ALTER TABLE "2022_03" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2022_03" DROP COLUMN ssa;
ALTER TABLE "2022_03" DROP COLUMN fips;

CREATE TABLE "2022_02" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2022_02"
FROM 'J:\medicare\CPSC_Enrollment_Info_2022_02.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2022_02" WHERE Enrolled = '*';
ALTER TABLE "2022_02" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2022_02" DROP COLUMN ssa;
ALTER TABLE "2022_02" DROP COLUMN fips;

CREATE TABLE "2022_01" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2022_01"
FROM 'J:\medicare\CPSC_Enrollment_Info_2022_01.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2022_01" WHERE Enrolled = '*';
ALTER TABLE "2022_01" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2022_01" DROP COLUMN ssa;
ALTER TABLE "2022_01" DROP COLUMN fips;

CREATE TABLE "2021_12" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2021_12"
FROM 'J:\medicare\CPSC_Enrollment_Info_2021_12.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2021_12" WHERE Enrolled = '*';
ALTER TABLE "2021_12" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2021_12" DROP COLUMN ssa;
ALTER TABLE "2021_12" DROP COLUMN fips;

CREATE TABLE "2021_11" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2021_11"
FROM 'J:\medicare\CPSC_Enrollment_Info_2021_11.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2021_11" WHERE Enrolled = '*';
ALTER TABLE "2021_11" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2021_11" DROP COLUMN ssa;
ALTER TABLE "2021_11" DROP COLUMN fips;

CREATE TABLE "2021_10" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2021_10"
FROM 'J:\medicare\CPSC_Enrollment_Info_2021_10.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2021_10" WHERE Enrolled = '*';
ALTER TABLE "2021_10" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2021_10" DROP COLUMN ssa;
ALTER TABLE "2021_10" DROP COLUMN fips;

CREATE TABLE "2021_09" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2021_09"
FROM 'J:\medicare\CPSC_Enrollment_Info_2021_09.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2021_09" WHERE Enrolled = '*';
ALTER TABLE "2021_09" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2021_09" DROP COLUMN ssa;
ALTER TABLE "2021_09" DROP COLUMN fips;

CREATE TABLE "2021_08" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2021_08"
FROM 'J:\medicare\CPSC_Enrollment_Info_2021_08.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2021_08" WHERE Enrolled = '*';
ALTER TABLE "2021_08" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2021_08" DROP COLUMN ssa;
ALTER TABLE "2021_08" DROP COLUMN fips;

CREATE TABLE "2021_07" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2021_07"
FROM 'J:\medicare\CPSC_Enrollment_Info_2021_07.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2021_07" WHERE Enrolled = '*';
ALTER TABLE "2021_07" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2021_07" DROP COLUMN ssa;
ALTER TABLE "2021_07" DROP COLUMN fips;

CREATE TABLE "2021_06" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2021_06"
FROM 'J:\medicare\CPSC_Enrollment_Info_2021_06.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2021_06" WHERE Enrolled = '*';
ALTER TABLE "2021_06" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2021_06" DROP COLUMN ssa;
ALTER TABLE "2021_06" DROP COLUMN fips;

CREATE TABLE "2021_05" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2021_05"
FROM 'J:\medicare\CPSC_Enrollment_Info_2021_05.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2021_05" WHERE Enrolled = '*';
ALTER TABLE "2021_05" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2021_05" DROP COLUMN ssa;
ALTER TABLE "2021_05" DROP COLUMN fips;

CREATE TABLE "2021_04" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2021_04"
FROM 'J:\medicare\CPSC_Enrollment_Info_2021_04.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2021_04" WHERE Enrolled = '*';
ALTER TABLE "2021_04" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2021_04" DROP COLUMN ssa;
ALTER TABLE "2021_04" DROP COLUMN fips;

CREATE TABLE "2021_03" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2021_03"
FROM 'J:\medicare\CPSC_Enrollment_Info_2021_03.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2021_03" WHERE Enrolled = '*';
ALTER TABLE "2021_03" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2021_03" DROP COLUMN ssa;
ALTER TABLE "2021_03" DROP COLUMN fips;

CREATE TABLE "2021_02" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2021_02"
FROM 'J:\medicare\CPSC_Enrollment_Info_2021_02.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2021_02" WHERE Enrolled = '*';
ALTER TABLE "2021_02" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2021_02" DROP COLUMN ssa;
ALTER TABLE "2021_02" DROP COLUMN fips;

CREATE TABLE "2021_01" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2021_01"
FROM 'J:\medicare\CPSC_Enrollment_Info_2021_01.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2021_01" WHERE Enrolled = '*';
ALTER TABLE "2021_01" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2021_01" DROP COLUMN ssa;
ALTER TABLE "2021_01" DROP COLUMN fips;

CREATE TABLE "2020_12" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2020_12"
FROM 'J:\medicare\CPSC_Enrollment_Info_2020_12.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2020_12" WHERE Enrolled = '*';
ALTER TABLE "2020_12" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2020_12" DROP COLUMN ssa;
ALTER TABLE "2020_12" DROP COLUMN fips;

CREATE TABLE "2020_11" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2020_11"
FROM 'J:\medicare\CPSC_Enrollment_Info_2020_11.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2020_11" WHERE Enrolled = '*';
ALTER TABLE "2020_11" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2020_11" DROP COLUMN ssa;
ALTER TABLE "2020_11" DROP COLUMN fips;

CREATE TABLE "2020_10" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2020_10"
FROM 'J:\medicare\CPSC_Enrollment_Info_2020_10.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2020_10" WHERE Enrolled = '*';
ALTER TABLE "2020_10" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2020_10" DROP COLUMN ssa;
ALTER TABLE "2020_10" DROP COLUMN fips;

CREATE TABLE "2020_09" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2020_09"
FROM 'J:\medicare\CPSC_Enrollment_Info_2020_09.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2020_09" WHERE Enrolled = '*';
ALTER TABLE "2020_09" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2020_09" DROP COLUMN ssa;
ALTER TABLE "2020_09" DROP COLUMN fips;

CREATE TABLE "2020_08" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2020_08"
FROM 'J:\medicare\CPSC_Enrollment_Info_2020_08.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2020_08" WHERE Enrolled = '*';
ALTER TABLE "2020_08" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2020_08" DROP COLUMN ssa;
ALTER TABLE "2020_08" DROP COLUMN fips;

CREATE TABLE "2020_07" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2020_07"
FROM 'J:\medicare\CPSC_Enrollment_Info_2020_07.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2020_07" WHERE Enrolled = '*';
ALTER TABLE "2020_07" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2020_07" DROP COLUMN ssa;
ALTER TABLE "2020_07" DROP COLUMN fips;

CREATE TABLE "2020_06" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2020_06"
FROM 'J:\medicare\CPSC_Enrollment_Info_2020_06.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2020_06" WHERE Enrolled = '*';
ALTER TABLE "2020_06" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2020_06" DROP COLUMN ssa;
ALTER TABLE "2020_06" DROP COLUMN fips;

CREATE TABLE "2020_05" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2020_05"
FROM 'J:\medicare\CPSC_Enrollment_Info_2020_05.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2020_05" WHERE Enrolled = '*';
ALTER TABLE "2020_05" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2020_05" DROP COLUMN ssa;
ALTER TABLE "2020_05" DROP COLUMN fips;

CREATE TABLE "2020_04" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2020_04"
FROM 'J:\medicare\CPSC_Enrollment_Info_2020_04.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2020_04" WHERE Enrolled = '*';
ALTER TABLE "2020_04" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2020_04" DROP COLUMN ssa;
ALTER TABLE "2020_04" DROP COLUMN fips;

CREATE TABLE "2020_03" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2020_03"
FROM 'J:\medicare\CPSC_Enrollment_Info_2020_03.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2020_03" WHERE Enrolled = '*';
ALTER TABLE "2020_03" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2020_03" DROP COLUMN ssa;
ALTER TABLE "2020_03" DROP COLUMN fips;

CREATE TABLE "2020_02" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2020_02"
FROM 'J:\medicare\CPSC_Enrollment_Info_2020_02.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2020_02" WHERE Enrolled = '*';
ALTER TABLE "2020_02" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2020_02" DROP COLUMN ssa;
ALTER TABLE "2020_02" DROP COLUMN fips;

CREATE TABLE "2020_01" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2020_01"
FROM 'J:\medicare\CPSC_Enrollment_Info_2020_01.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2020_01" WHERE Enrolled = '*';
ALTER TABLE "2020_01" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2020_01" DROP COLUMN ssa;
ALTER TABLE "2020_01" DROP COLUMN fips;

CREATE TABLE "2019_12" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2019_12"
FROM 'J:\medicare\CPSC_Enrollment_Info_2019_12.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2019_12" WHERE Enrolled = '*';
ALTER TABLE "2019_12" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2019_12" DROP COLUMN ssa;
ALTER TABLE "2019_12" DROP COLUMN fips;

CREATE TABLE "2019_11" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2019_11"
FROM 'J:\medicare\CPSC_Enrollment_Info_2019_11.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2019_11" WHERE Enrolled = '*';
ALTER TABLE "2019_11" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2019_11" DROP COLUMN ssa;
ALTER TABLE "2019_11" DROP COLUMN fips;

CREATE TABLE "2019_10" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2019_10"
FROM 'J:\medicare\CPSC_Enrollment_Info_2019_10.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2019_10" WHERE Enrolled = '*';
ALTER TABLE "2019_10" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2019_10" DROP COLUMN ssa;
ALTER TABLE "2019_10" DROP COLUMN fips;

CREATE TABLE "2019_09" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2019_09"
FROM 'J:\medicare\CPSC_Enrollment_Info_2019_09.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2019_09" WHERE Enrolled = '*';
ALTER TABLE "2019_09" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2019_09" DROP COLUMN ssa;
ALTER TABLE "2019_09" DROP COLUMN fips;

CREATE TABLE "2019_08" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2019_08"
FROM 'J:\medicare\CPSC_Enrollment_Info_2019_08.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2019_08" WHERE Enrolled = '*';
ALTER TABLE "2019_08" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2019_08" DROP COLUMN ssa;
ALTER TABLE "2019_08" DROP COLUMN fips;

CREATE TABLE "2019_07" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2019_07"
FROM 'J:\medicare\CPSC_Enrollment_Info_2019_07.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2019_07" WHERE Enrolled = '*';
ALTER TABLE "2019_07" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2019_07" DROP COLUMN ssa;
ALTER TABLE "2019_07" DROP COLUMN fips;

CREATE TABLE "2019_06" (
	ContractID VARCHAR(20),
	PlanID INTEGER,
	SSA VARCHAR(20),
	FIPS VARCHAR(20),
	State VARCHAR(2),
	County VARCHAR(100),
	Enrolled TEXT
);

COPY "2019_06"
FROM 'J:\medicare\CPSC_Enrollment_Info_2019_06.csv'
DELIMITER ','
CSV HEADER;

DELETE FROM "2019_06" WHERE Enrolled = '*';
ALTER TABLE "2019_06" ALTER COLUMN enrolled TYPE integer USING (enrolled::integer);
ALTER TABLE "2019_06" DROP COLUMN ssa;
ALTER TABLE "2019_06" DROP COLUMN fips;

SELECT * FROM public."2019_10";